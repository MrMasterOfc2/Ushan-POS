<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="UTF-8">
<title>CHANDANA STORES - POS</title>

<style>
/* =========================
   ORIGINAL STYLES (UNCHANGED)
   ========================= */

:root {
    --main-blue:#1a237e;
    --success-green:#2e7d32;
    --error-red:#c62828;
    --warning-orange:#ff9800;
    --bg-primary:#ffffff;
    --bg-secondary:#f5f6fa;
    --text-primary:#000;
    --border-color:#ddd;
}

body{
    margin:0;
    font-family:Segoe UI,Arial;
    background:var(--bg-secondary);
    color:var(--text-primary);
}

/* ---------- HEADER ---------- */
header{
    background:var(--main-blue);
    color:white;
    padding:15px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

/* ---------- TABS ---------- */
.nav-tabs{
    display:flex;
    background:white;
    border-bottom:1px solid #ddd;
}
.tab-btn{
    padding:15px;
    border:none;
    background:none;
    font-weight:bold;
    cursor:pointer;
}
.tab-btn.active{
    color:var(--main-blue);
    border-bottom:3px solid var(--main-blue);
}

/* ---------- VIEWS ---------- */
.view-section{
    display:none;
    padding:10px;
}
.view-section.active-view{
    display:flex;
    gap:10px;
}

/* ---------- POS ---------- */
.inventory-section,.billing-section{
    background:white;
    padding:15px;
    border-radius:8px;
    flex:1;
}

/* ---------- TABLE ---------- */
table{width:100%;border-collapse:collapse;}
th,td{padding:8px;border-bottom:1px solid #ddd;}
tr:hover{background:#f0f0f0;cursor:pointer}

/* ---------- CART ---------- */
#cartList li{
    display:flex;
    justify-content:space-between;
    padding:8px;
    border-bottom:1px solid #ddd;
}

/* ---------- POPUP ---------- */
.popup-overlay{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.7);
    justify-content:center;
    align-items:center;
    z-index:999;
}
.popup-content{
    background:white;
    padding:20px;
    width:400px;
    border-radius:10px;
}

/* =========================
   üî• PRINT FIX (IMPORTANT)
   ========================= */

#printableReceipt{
    display:block;          /* ‚ùå was display:none */
    visibility:hidden;      /* screen ‡∂ë‡∂ö‡∂ß ‡∂±‡∑ú‡∂¥‡∑ö‡∂±‡∑ä‡∂± */
}

/* PRINT ONLY */
@media print {

    body *{
        visibility:hidden;
    }

    #printableReceipt,
    #printableReceipt *{
        visibility:visible;
    }

    #printableReceipt{
        position:absolute;
        left:0;
        top:0;
        width:80mm;
        padding:10px;
        background:white;
        color:black;
        font-family:"Courier New",monospace;
        font-size:13px;
    }

    header,.nav-tabs,.popup-overlay{
        display:none !important;
    }
}
</style>
</head>

<body>

<header>
    <b>CHANDANA STORES</b>
    <span id="stats">‡∂Ü‡∂Ø‡∑è‡∂∫‡∂∏: 0 | ‡∂Ω‡∑è‡∂∑‡∂∫: 0</span>
</header>

<div class="nav-tabs">
    <button class="tab-btn active" onclick="switchView('pos')" id="tab-pos">POS</button>
</div>

<div id="pos-view" class="view-section active-view">

<section class="inventory-section">
    <h3>Inventory</h3>
    <table>
        <thead>
            <tr><th>ID</th><th>Name</th><th>Price</th><th>Stock</th></tr>
        </thead>
        <tbody id="inventoryBody"></tbody>
    </table>
    <button onclick="addToCart()">Add to Cart</button>
</section>

<section class="billing-section">
    <h3>Cart</h3>
    <ul id="cartList"></ul>
    <div><b>Total: Rs. <span id="grandTotal">0.00</span></b></div>
    <button onclick="checkout()">PAY</button>
</section>

</div>

<!-- RECEIPT POPUP -->
<div id="receiptPopup" class="popup-overlay">
  <div class="popup-content">
    <h3>Receipt</h3>
    <div id="receiptPreviewBox"></div>
    <button onclick="printReceipt()">üñ® Print</button>
    <button onclick="closeReceiptPopup()">Close</button>
  </div>
</div>

<!-- PRINT AREA -->
<div id="printableReceipt"></div>

<script>
/* =========================
   ORIGINAL JS (LOGIC SAME)
   ========================= */

let inventory=[
 {id:1,name:"Sugar",price:150,stock:10},
 {id:2,name:"Rice",price:200,stock:15}
];
let cart=[];

function switchView(v){}

function renderTable(){
    inventoryBody.innerHTML=inventory.map(i=>`
        <tr onclick="selectRow(${i.id})">
            <td>${i.id}</td>
            <td>${i.name}</td>
            <td>${i.price}</td>
            <td>${i.stock}</td>
        </tr>`).join("");
}
renderTable();

let selectedId=null;
function selectRow(id){selectedId=id;}

function addToCart(){
    if(!selectedId) return alert("Select item");
    let item=inventory.find(i=>i.id===selectedId);
    cart.push({...item,qty:1});
    updateCart();
}

function updateCart(){
    let total=0;
    cartList.innerHTML=cart.map(c=>{
        total+=c.price;
        return `<li>${c.name}<span>Rs.${c.price}</span></li>`;
    }).join("");
    grandTotal.innerText=total.toFixed(2);
}

function checkout(){
    let date=new Date().toLocaleString();
    let html=`
    <div style="text-align:center">
        <b>CHANDANA STORES</b><br>
        ${date}
    </div><hr>`;
    cart.forEach(c=>{
        html+=`<div style="display:flex;justify-content:space-between">
            <span>${c.name}</span><span>Rs.${c.price}</span>
        </div>`;
    });
    html+=`<hr><b>TOTAL: Rs.${grandTotal.innerText}</b>`;

    receiptPreviewBox.innerHTML=html;
    printableReceipt.innerHTML=html;
    receiptPopup.style.display="flex";
    cart=[];
    updateCart();
}

function closeReceiptPopup(){
    receiptPopup.style.display="none";
}

/* üî• PRINT FIX */
function printReceipt(){
    setTimeout(()=>{ window.print(); },300);
}
</script>

</body>
</html>
