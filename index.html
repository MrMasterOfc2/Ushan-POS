<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CHANDANA POS SYSTEM</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a237e">

    <style>
        /* ‡∂∏‡∑ì‡∂ß ‡∂¥‡∑ô‡∂ª ‡∂Ø‡∑î‡∂±‡∑ä ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ CSS ‡∂∏‡∑ù‡∑É‡∑ä‡∂≠‡∂ª ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂Ö‡∂©‡∂Ç‡∂ú‡∑î ‡∑Ä‡∑ö */
        :root { --main-blue: #1a237e; --success: #2e7d32; --danger: #c62828; --light: #f5f6fa; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--light); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        header { background: var(--main-blue); color: white; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; }
        .nav-tabs { background: #e8eaf6; display: flex; padding: 5px 20px; border-bottom: 2px solid #ddd; }
        .tab-btn { padding: 12px 20px; border: none; background: #c5cae9; cursor: pointer; border-radius: 5px 5px 0 0; font-weight: bold; margin-right: 5px; }
        .tab-btn.active { background: white; border: 1px solid #ddd; border-bottom: 3px solid white; }

        .page { display: none; flex: 1; padding: 15px; gap: 15px; overflow: hidden; }
        .page.active { display: flex; }

        /* Responsive Design: Mobile ‡∑É‡∂≥‡∑Ñ‡∑è ‡∑É‡∑ä‡∑Ä‡∂∫‡∂Ç‡∂ö‡∑ä‚Äç‡∂ª‡∑ì‡∂∫‡∑Ä ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∑Ä‡∑ì‡∂∏ */
        @media (max-width: 768px) {
            .page.active { flex-direction: column; overflow-y: auto; }
            .billing-section { min-width: 100%; height: auto; }
        }

        /* Tables & Inputs */
        .inventory-section { flex: 2; background: white; border-radius: 10px; display: flex; flex-direction: column; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .billing-section { flex: 1; background: white; border-radius: 10px; display: flex; flex-direction: column; padding: 15px; border-left: 5px solid var(--main-blue); }
        .scroll-box { flex: 1; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #eee; padding: 12px; position: sticky; top: 0; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        .btn { padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; }
        .btn:active { transform: scale(0.98); }
    </style>
</head>
<body>

<header>
    <div style="font-size: 22px; font-weight: bold;">CHANDANA STORES</div>
    <div id="stats" style="color: #ccff90;">‡∂Ü‡∂Ø‡∑è‡∂∫‡∂∏: 0.00 | ‡∂Ω‡∑è‡∂∑‡∂∫: 0.00</div>
</header>

<nav class="nav-tabs">
    <button class="tab-btn active" onclick="showPage('sales-page', this)">‡∑Ä‡∑í‡∂ö‡∑î‡∂´‡∑î‡∂∏‡∑ä (Sales)</button>
    <button class="tab-btn" onclick="showPage('stock-page', this)">‡∑É‡∑ä‡∂ß‡∑ú‡∂ö‡∑ä ‡∑É‡∑Ñ ‡∑Ä‡∑è‡∂ª‡∑ä‡∂≠‡∑è</button>
</nav>

<div id="sales-page" class="page active">
    <section class="inventory-section">
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <input type="text" id="searchInput" style="flex:1; padding:12px; font-size:16px;" placeholder="‡∂∑‡∑è‡∂´‡∑ä‡∂©‡∂∫ ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂± ‡∑Ñ‡∑ù Scan ‡∂ö‡∂ª‡∂±‡∑ä‡∂±..." onkeyup="searchItem()">
            <button id="lockBtn" class="btn" style="background:#ff9800;" onclick="handleSecurity()">üîí Unlock</button>
        </div>
        <div class="scroll-box">
            <table>
                <thead><tr><th>ID</th><th>‡∂±‡∂∏</th><th>‡∂∏‡∑í‡∂Ω</th><th>‡∑É‡∑ä‡∂ß‡∑ú‡∂ö‡∑ä</th></tr></thead>
                <tbody id="inventoryBody"></tbody>
            </table>
        </div>
        <button class="btn" style="background: var(--main-blue); margin-top: 15px; font-size:16px;" onclick="addToCart()">‡∂ö‡∑è‡∂ª‡∑ä‡∂ß‡∑ä ‡∂ë‡∂ö‡∂ß ‡∂Ø‡∑è‡∂±‡∑ä‡∂± (+)</button>
    </section>

    <section class="billing-section">
        <h3 style="margin-top:0;">‡∑Ä‡∂≠‡∑ä‡∂∏‡∂±‡∑ä ‡∂∂‡∑í‡∂Ω</h3>
        <div class="scroll-box"><ul id="cartList" style="list-style:none; padding:0;"></ul></div>
        <div style="font-size: 24px; font-weight: bold; color: var(--danger); padding: 10px 0;">‡∂ë‡∂ö‡∂≠‡∑î‡∑Ä: <span id="grandTotal">0.00</span></div>
        <button class="btn" style="background:var(--success); width:100%; font-size:20px; padding:15px;" onclick="checkout()">‡∂∂‡∑í‡∂Ω‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (PAY)</button>
    </section>
</div>

<div id="stock-page" class="page" style="flex-direction: column; overflow-y: auto;">
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <div style="background:white; padding:20px; border-radius:10px; text-align:center; border:1px solid #ddd;">
            <p>‡∂Ö‡∂Ø ‡∂Ø‡∑í‡∂± ‡∂Ω‡∑è‡∂∑‡∂∫</p><h2 id="todayProfit" style="color:var(--success)">0.00</h2>
        </div>
        <div style="background:white; padding:20px; border-radius:10px; text-align:center; border:1px solid #ddd;">
            <p>‡∂∏‡∑î‡∑Ö‡∑î ‡∑É‡∑ä‡∂ß‡∑ú‡∂ö‡∑ä ‡∑Ä‡∑í‡∂∫‡∂Ø‡∂∏</p><h2 id="totalStockCost" style="color:var(--danger)">0.00</h2>
        </div>
    </div>

    <div style="background:white; padding:20px; border-radius:10px; margin-top:20px; border:1px solid #ddd;">
        <h3>‡∂Ö‡∂Ω‡∑î‡∂≠‡∑ä ‡∑É‡∑ä‡∂ß‡∑ú‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏</h3>
        <div style="display:flex; flex-wrap:wrap; gap:10px;">
            <input type="text" id="stName" style="padding:10px; flex:1;" placeholder="‡∂∑‡∑è‡∂´‡∑ä‡∂©‡∂∫‡∑ö ‡∂±‡∂∏">
            <input type="number" id="stCost" style="padding:10px; width:120px;" placeholder="‡∂ú‡∑ê‡∂±‡∑î‡∂∏‡∑ä ‡∂∏‡∑í‡∂Ω">
            <input type="number" id="stQty" style="padding:10px; width:100px;" placeholder="‡∂¥‡∑ä‚Äç‡∂ª‡∂∏‡∑è‡∂´‡∂∫">
            <button class="btn" style="background:var(--success);" onclick="addNewStock()">‡∑É‡∑ö‡∑Ä‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
        </div>
    </div>
</div>

<script>
    // ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫‡∑ö ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ JavaScript ‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂á‡∂≠
    let inventory = [];
    let cart = [];
    let stockHistory = [];
    let salesHistory = [];
    let isLocked = true;
    let selectedId = null;

    // ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫ ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑‡∂∫
    function initialize() {
        const savedInv = localStorage.getItem('chandana_db');
        const savedStock = localStorage.getItem('stock_history');
        const savedSales = localStorage.getItem('sales_history');
        
        inventory = savedInv ? JSON.parse(savedInv) : [];
        stockHistory = savedStock ? JSON.parse(savedStock) : [];
        salesHistory = savedSales ? JSON.parse(savedSales) : [];

        // ‡∂∂‡∂©‡∑î 200‡∂ö‡∑ä ‡∂∏‡∑î‡∂Ω‡∑í‡∂±‡∑ä‡∂∏ ‡∂±‡∑ê‡∂≠‡∑í‡∂±‡∂∏‡∑ä ‡∑É‡∑ë‡∂Ø‡∑ì‡∂∏
        if (inventory.length === 0) {
            for (let i = 1; i <= 200; i++) {
                inventory.push({ id: i, name: "‡∂∑‡∑è‡∂´‡∑ä‡∂©‡∂∫ " + i, cost: 100, price: 150, stock: 50 });
            }
        }
        renderTable();
        updateReports();
    }

    function showPage(pageId, btn) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        btn.classList.add('active');
        if(pageId === 'stock-page') updateReports();
    }

    function saveAll() {
        localStorage.setItem('chandana_db', JSON.stringify(inventory));
        localStorage.setItem('stock_history', JSON.stringify(stockHistory));
        localStorage.setItem('sales_history', JSON.stringify(salesHistory));
    }

    function renderTable() {
        const body = document.getElementById('inventoryBody');
        body.innerHTML = inventory.map(item => `
            <tr onclick="selectRow(${item.id})" id="row-${item.id}">
                <td>${item.id}</td>
                <td onclick="directEdit(${item.id}, 'name')">${item.name}</td>
                <td onclick="directEdit(${item.id}, 'price')">${item.price.toFixed(2)}</td>
                <td>${item.stock}</td>
            </tr>
        `).join('');
    }

    function selectRow(id) {
        selectedId = id;
        document.querySelectorAll('tr').forEach(r => r.style.background="");
        document.getElementById('row-'+id).style.background="#e3f2fd";
    }

    function addToCart() {
        if(!selectedId) return;
        let item = inventory.find(i => i.id === selectedId);
        cart.push({...item});
        updateCartUI();
    }

    function updateCartUI() {
        let gt = 0;
        document.getElementById('cartList').innerHTML = cart.map((c, i) => {
            gt += c.price;
            return `<li style="padding:10px; border-bottom:1px solid #eee; display:flex; justify-content:space-between;">
                        <span>${c.name}</span>
                        <span>${c.price.toFixed(2)} <b style="color:red; cursor:pointer;" onclick="cart.splice(${i},1); updateCartUI();">X</b></span>
                    </li>`;
        }).join('');
        document.getElementById('grandTotal').innerText = gt.toFixed(2);
    }

    function checkout() {
        if (cart.length === 0) return;
        let billProfit = 0;
        let billTotal = 0;
        let today = new Date().toLocaleDateString();

        cart.forEach(c => {
            let item = inventory.find(i => i.id === c.id);
            if (item.stock > 0) item.stock--;
            billTotal += c.price;
            billProfit += (c.price - item.cost);
        });

        salesHistory.push({ date: today, total: billTotal, profit: billProfit });
        saveAll();
        cart = []; updateCartUI(); renderTable();
        alert("‡∂∂‡∑í‡∂Ω ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í!");
    }

    function addNewStock() {
        let name = document.getElementById('stName').value;
        let cost = parseFloat(document.getElementById('stCost').value);
        let qty = parseInt(document.getElementById('stQty').value);
        if (name && cost && qty) {
            stockHistory.push({ date: new Date().toLocaleDateString(), name, cost, qty });
            let item = inventory.find(i => i.name.toLowerCase() === name.toLowerCase());
            if (item) { item.stock += qty; item.cost = cost; }
            saveAll(); renderTable(); updateReports();
            alert("‡∑É‡∑ä‡∂ß‡∑ú‡∂ö‡∑ä ‡∂∫‡∑è‡∑Ä‡∂≠‡∑ä‡∂ö‡∑è‡∂Ω‡∑ì‡∂± ‡∑Ä‡∑í‡∂∫!");
        }
    }

    function updateReports() {
        let today = new Date().toLocaleDateString();
        let tProfit = salesHistory.filter(s => s.date === today).reduce((a, b) => a + b.profit, 0);
        let tCost = stockHistory.reduce((a, b) => a + (b.cost * b.qty), 0);
        document.getElementById('todayProfit').innerText = tProfit.toFixed(2);
        document.getElementById('totalStockCost').innerText = tCost.toFixed(2);
        document.getElementById('stats').innerText = `‡∂Ü‡∂Ø‡∑è‡∂∫‡∂∏: ${salesHistory.reduce((a,b)=>a+b.total,0).toFixed(2)} | ‡∂Ω‡∑è‡∂∑‡∂∫: ${tProfit.toFixed(2)}`;
    }

    function handleSecurity() {
        let p = prompt("PIN ‡∂Ö‡∂Ç‡∂ö‡∂∫ ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (1234):");
        if(p === "1234") { isLocked = false; document.getElementById('lockBtn').style.background="#4caf50"; alert("Unlocked!"); }
    }

    function directEdit(id, field) {
        if(isLocked) return;
        let item = inventory.find(i => i.id === id);
        let val = prompt("‡∂±‡∑Ä ‡∂Ö‡∂ú‡∂∫:", item[field]);
        if(val) { item[field] = (field==='name')?val:parseFloat(val); saveAll(); renderTable(); }
    }

    function searchItem() {
        let f = document.getElementById('searchInput').value.toLowerCase();
        let rows = document.getElementById('inventoryBody').getElementsByTagName('tr');
        for(let r of rows) { r.style.display = r.innerText.toLowerCase().includes(f) ? "" : "none"; }
    }

    window.onload = initialize;
</script>

</body>
</html>
